<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Y2KDripstore</title>
<style>
  body{margin:0;font-family:sans-serif;overflow-x:hidden;}
  .welcome{height:50vh;display:flex;align-items:center;justify-content:center;font-size:2.5rem;font-weight:bold;animation:colorChange 6s infinite;text-align:center;}
  @keyframes colorChange{0%{color:red;}33%{color:green;}66%{color:blue;}100%{color:red;}}
  #categories{display:flex;gap:10px;padding:10px;overflow-x:auto;background:#f2f2f2;}
  #categories a{padding:8px 12px;background:#222;color:white;text-decoration:none;border-radius:5px;}
  #product-container{display:flex;flex-direction:column;align-items:center;gap:15px;padding:10px;max-height:60vh;overflow-y:auto;}
  .product,.ad{width:95%;border:1px solid #ccc;padding:10px;border-radius:5px;text-align:center;}
  .product img{width:100%;height:auto;}
  .ad{background:#eee;font-weight:bold;}
  .about{padding:20px;background:#f9f9f9;}
  footer{padding:10px;text-align:center;background:#222;color:white;}
  .modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;overflow:auto;}
  .modal-content{background:white;padding:20px;border-radius:10px;text-align:center;max-width:500px;width:90%;}
  .modal-content img{width:100%;height:auto;}
  .buy-button{padding:10px 20px;background:red;color:white;border:none;border-radius:5px;font-size:1rem;cursor:pointer;margin-top:10px;}
  #authContainer{padding:10px;display:flex;gap:10px;flex-direction:column;max-width:400px;margin:auto;}
  #authContainer input{padding:8px;font-size:1rem;}
  #authContainer button{padding:10px;background:green;color:white;border:none;border-radius:5px;cursor:pointer;}
  #searchInput{width:95%;padding:8px;margin:10px auto;display:block;border-radius:5px;border:1px solid #ccc;}
  .form-group{margin-bottom:10px;text-align:left;}
  .form-group label{display:block;margin-bottom:5px;}
  .form-group input{width:100%;padding:8px;border-radius:5px;border:1px solid #ccc;}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.10.2/dist/supabase.min.js"></script>
<!-- PayPal -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=ZAR"></script>

</head>
<body>

<div class="welcome">WELCOME TO Y2KDRIPSTORE - SHOP THE LATEST DRIP</div>

<input type="text" id="searchInput" placeholder="Search products...">

<div id="categories">
  <a href="#" data-category="Men">Men</a>
  <a href="#" data-category="Women">Women</a>
  <a href="#" data-category="Girls">Girls</a>
  <a href="#" data-category="Boys">Boys</a>
  <a href="#" data-category="Sneakers">Sneakers</a>
  <a href="#" data-category="Iphones">iPhones</a>
</div>

<div id="product-container"></div>

<div class="about">
  <h2>About Us</h2>
  <p>Facebook: <a href="https://www.facebook.com/profile.php?id=61559868803161" target="_blank">Y2kdripncoupledrip</a></p>
  <p>WhatsApp: <a href="https://wa.me/0685270789">0685270789</a></p>
  <p>WhatsApp Group: <a href="https://chat.whatsapp.com/HOCcS6OCWWAFfGpJr4nBQs?mode=ac_t">Join Here</a></p>
  <p>Location: Gauteng, Johannesburg, Anderson Street, 001</p>
  <p>Delivery: 2 to 7 days nationwide & worldwide</p>
  <p>Partnered with: THE BOSS TECH, IMILE, IPHONE STORE, HOODLAND, BUFFALO, and many more companies</p>
  <p>Website Credits: UmlandoSimah42, Thando Mangema12, brightsphelele92, ThamisanqaSmith90</p>
  <p>Owner: JD Higgins</p>
  <p>Delivery refund: within 30 days</p>
</div>

<footer>&copy; 2025 Y2KDripstore - All Rights Reserved</footer>

<div id="authContainer">
  <h3>Login / Signup</h3>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button onclick="signup()">Signup</button>
  <button onclick="login()">Login</button>
  <button onclick="logout()">Logout</button>
  <div id="userInfo"></div>
</div>

<div id="productModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <img id="modalImage" src="" alt="Product Image">
    <div class="product-name" id="modalName"></div>
    <div class="product-price" id="modalPrice"></div>
    <div id="checkoutForm">
      <div class="form-group"><label>Name:</label><input type="text" id="buyerName"></div>
      <div class="form-group"><label>ID Number:</label><input type="text" id="buyerID"></div>
      <div class="form-group"><label>Address:</label><input type="text" id="buyerAddress"></div>
      <div class="form-group"><label>Phone:</label><input type="text" id="buyerPhone"></div>
    </div>
    <div id="paypal-button-container"></div>
  </div>
</div>

<script>
// ===== Firebase Config =====
const firebaseConfig = {
  apiKey: "YOUR_FIREBASE_KEY",
  authDomain: "YOUR_FIREBASE_PROJECT.firebaseapp.com",
  projectId: "YOUR_FIREBASE_PROJECT",
  storageBucket: "YOUR_FIREBASE_PROJECT.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// ===== Supabase Config =====
const supabaseUrl = 'https://ukymkharlrkubjbwyjka.supabase.co';
const supabaseKey = 'PUBLIC_SUPABASE_KEY';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// ===== Auth Functions =====
function signup(){
  const email=document.getElementById('email').value;
  const password=document.getElementById('password').value;
  auth.createUserWithEmailAndPassword(email,password)
    .then(user=>document.getElementById('userInfo').textContent='Signed Up: '+user.user.email)
    .catch(err=>alert(err.message));
}
function login(){
  const email=document.getElementById('email').value;
  const password=document.getElementById('password').value;
  auth.signInWithEmailAndPassword(email,password)
    .then(user=>document.getElementById('userInfo').textContent='Logged in: '+user.user.email)
    .catch(err=>alert(err.message));
}
function logout(){auth.signOut().then(()=>document.getElementById('userInfo').textContent='Logged out');}

// ===== Load Products from Google Sheet =====
const sheetURL='https://sheetdb.io/api/v1/v7ywti39d24bj'; // Replace with your sheet URL
let allProducts=[];
async function loadProducts(){
  try{
    const res=await fetch(sheetURL);
    const data=await res.json();
    allProducts=data.map(p=>({
      name:p.ProductName,
      price:parseFloat(p.Price),
      category:p.Category,
      image:p.ImageURL
    }));
    renderProducts(allProducts);
  }catch(err){console.error('Error loading products',err);}
}
loadProducts();

// ===== Render Products with Ads =====
function renderProducts(products){
  const container=document.getElementById('product-container');
  container.innerHTML='';
  let count=0;
  products.forEach(p=>{
    const div=document.createElement('div');
    div.className='product';
    div.innerHTML=`<img src="${p.image}"><div class="product-name">${p.name}</div><div class="product-price">R${p.price}</div>`;
    div.onclick=()=>openModal(p);
    container.appendChild(div);
    count++;
    if(count%2===0){
      const ad=document.createElement('div');
      ad.className='ad';
      ad.textContent='Ad Space 10%';
      container.appendChild(ad);
    }
  });
}

// ===== Category Filter =====
document.querySelectorAll('#categories a').forEach(cat=>{
  cat.addEventListener('click', e=>{
    e.preventDefault();
    const c=cat.dataset.category;
    const filtered=allProducts.filter(p=>p.category.toLowerCase()===c.toLowerCase());
    renderProducts(filtered);
  });
});

// ===== Search =====
document.getElementById('searchInput').addEventListener('input', e=>{
  const q=e.target.value.toLowerCase();
  const filtered=allProducts.filter(p=>p.name.toLowerCase().includes(q));
  renderProducts(filtered);
});

// ===== Modal =====
let currentProduct=null;
function openModal(product){
  currentProduct=product;
  document.getElementById('modalImage').src=product.image;
  document.getElementById('modalName').textContent=product.name;
  document.getElementById('modalPrice').textContent='R'+product.price;
  document.getElementById('productModal').style.display='flex';
  renderPaypalButton();
}
function closeModal(){document.getElementById('productModal').style.display='none';}

// ===== Smooth Vertical Scroll =====
const container=document.getElementById('product-container');
let isDown=false,startY,scrollTop;
container.addEventListener('mousedown',e=>{isDown=true;startY=e.pageY-container.offsetTop;scrollTop=container.scrollTop;});
container.addEventListener('mouseleave',e=>isDown=false);
container.addEventListener('mouseup',e=>isDown=false);
container.addEventListener('mousemove',e=>{if(!isDown) return; e.preventDefault(); const y=e.pageY-container.offsetTop; const walk=(y-startY)*2; container.scrollTop=scrollTop-walk;});

// ===== PayPal Button =====
function renderPaypalButton(){
  document.getElementById('paypal-button-container').innerHTML='';
  paypal.Buttons({
    style: {layout:'vertical',color:'gold',shape:'rect',label:'paypal'},
    createOrder: function(data, actions){
      const name=document.getElementById('buyerName').value;
      const idNum=document.getElementById('buyerID').value;
      const address=document.getElementById('buyerAddress').value;
      const phone=document.getElementById('buyerPhone').value;
      if(!name||!idNum||!address||!phone){alert('Please fill all details'); return;}
      return actions.order.create({
        purchase_units:[{
          amount:{value:currentProduct.price},
          description:currentProduct.name
        }]
      });
    },
    onApprove: function(data, actions){
      return actions.order.capture().then(async function(details){
        alert('Payment completed by '+details.payer.name.given_name);
        const userEmail=auth.currentUser?auth.currentUser.email:'guest';
        const {error}=await supabase.from('orders').insert([{
          user:userEmail,
          product:currentProduct.name,
          price:currentProduct.price,
          name:document.getElementById('buyerName').value,
          idNumber:document.getElementById('buyerID').value,
          address:document.getElementById('buyerAddress').value,
          phone:document.getElementById('buyerPhone').value,
          paypalId:details.id
        }]);
        if(error){console.error(error); alert('Order save failed');}else{alert('Order saved successfully');}
        closeModal();
      });
    }
  }).render('#paypal-button-container');
}
</script>

</body>
  </html>
